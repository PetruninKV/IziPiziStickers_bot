<h1>Dev</h1>

## 11.06.2023
1. Пользователи могут поделиться своими получившимися стикерпаками с ботом.
   - Для этого им необходимо отправить команду /feedback с ссылкой на стикерпак (https://t.me/addstickers/). Бот перешлет ссылку администратору.
   - Если ссылка будет другого формата, бот уведомит об этом пользователя.


## 05.06.2023
1. Хранение состояний взаимодействия пользователей с ботом в Redis.
2. Хранение списка пользователей:
   - которые когда либо взаимодействовали с ботом
   - активные пользователи. Список динамически изменяется учитывая, кто из пользователей блокирует/разблокирует бота. На основе этого списка происходит рассылка сообщений от лица администратора.


## 29.05.2023
1. Добавлен список, хранящий активных пользователей:
    - при нажати на /start пользователь попадает в список
    - при блокировки бота пользователь удаляется из списка
    - при разблокировки бота пользователь добавляется в список
2. Отправив команду /admin, открывается панель администратора.
    - команда доступна только для пользователей с указанным в конфигурации id
    - обычные команды перестают быть доступными для администратора
    - бот присылает описание доступных команд. На этом этапе администратор может совершить следующие действия:
      - отправить в чат команду /stat
      - отправить в чат команду /ban или /unban:
        - администратор переходит в режим работы с изменением списка заблокированных пользователей
        - бот предложит ввести id пользователей, которых необходимо добавить/удалить в blacklist
        - отправленное сообщение бот обработает и добавит/удалит в blacklist
        - доступна команда /cancel для возврата в режим администратора
      - отправить в чат команду /blacklist
        - бот пришлет список заблокированных пользователей
      - отправить в чат команду /text:
        - администратор переходит в режим общения с пользователями
        - бот предлагает прислать сообщение, которое он перешлет пользователям
        - доступна команда /cancel для возврата в режим администратора
        - на отправленное сообщение бот попросит подтверждение отправки:
          - при нажатии 'Отправить' бот отправит сообщения пользователям из списка активных. Если каким-то пользователям не получится отправить сообщение по какой-то причине, бот покажет id этих пользователей
          - при нажатии 'Отменить' бот предложит прислать новое сообщение для перессылки
          - на любые другие сообщения бот не реагирует
        - доступна команда /exit для выхода из режима администратора
      - отправить в чат команду /exit:
        - становятся недоступны команды администратора
        - восстанавливается доступ к командам обычных пользователей
      - отправить в чат любое другое сообщение:
        - бот присылает описание доступных команд в режиме администратора.
3. Сбор статистики использования бота.
    - сообещения от пользователей делятся условно на три типа: команды, фото/документ для форматирования и все остальные(flood).
    - с помощью InfluxDB формируется база данных временных рядов содержащая id пользователя и тип отправленного сообщения
    - с помощью Grafana данные визуализируются:
      - количество используемых команд
      - количество отформатированных фото
      - активность пользователя (измеряется общим количество отправленных боту сообщений)
      - список сообщений из категории flood или которые попали туда случайно.


## 16.05.2023
1. Бот уведомляет о загрузке документа в моменты демонстарции работы и после форматирования фото пользователя.
2. Установлен троттлинг:
    - 10сек на повторную обработку фото
    - 1cек на использование команд из меню
    - 20сек на любые другие сообщения
3. Бот реагирует только на сообщения, отправленные лично.
4. Сообщения от пользователей, находящихся в списке заблокированных, не обрабатываются.


<h1>Release</h1>

## 24.04.2023
## Описание взаимодействия с ботом.

1. Пользователь отправляет команду /start боту (или запускает его, найдя в поиске)
2. Бот приветствует пользователя и предлагает познакомиться с описанием работы бота, отправив команду /about
3. На этом этапе пользователь может совершить следующие действия:
    - отправить в чат команду /instruction
    - отправить в чат команду /about
    - отправить в чат команду /demo
    - отправить в чат команду /formatting
    - отправить в чат команду /stop_formatting
    - отправить в чат команду /privacy
    - отправить в чат команду /lang
    - отправить в чат команду /help
    - отправить в чат любое другое сообщение
4. Пользователь отправляет в чат команду /instruction:
    - бот присылает ссылку telegra.ph на статью о создании стикеров и ссылку на документацию от Telegram
5. Пользователь отправляет в чат команду /about:
    - бот коротко описывает процесс создания собственных стикеров в Telegram, своё участие в данном процессе и предлагает посмотреть результат работы бота отправив /demo
6. Пользователь отправляет в чат команду /demo:
    - бот демонстрирует свою работу: показывает исходное изображение и обработанное, подходящее для создания стикера. Предлагает пользователю попробовать работу бота со своими фото, отправив команду /formatting
7. Пользователь отправляет в чат команду /formatting:
    - включается режим форматирования фото, и бот сообщает об этом. Выйти из этого режима можно командой - /stop_formatting. В данном режиме бот принимает от пользователя только фотографии, документы формата jpg, png, webp, и команду для выхода из режима редактирования. На все другие сообщения от пользователя бот реагирует напоминанием о том, что включен режим редактирования фото
    - с помощью команды - /stop_formatting, завершается режим редактирования фото и пользователю снова доступны все команды бота.
8. Пользователь отправляет в чат команду /stop_formatting:
    - бот сообщает, что пользователь находится вне режима редактирования фото
9. Пользователь отправляет в чат команду /privacy:
    - бот сообщает, что в процессе работы не сохраняет файлы пользователей и предлагает ознакомиться с кодом приложения на GitHub.
10. Пользователь отправляет в чат команду /lang:
    - (не реализовано) бот предлагает пользователю сменить язык
11. Пользователь отправляет в чат команду /help:
    - сообщает, что для запуска режима редактирования фото нужно использовать /formatting. А подробную инструкцию о создании стикеров в Telegram можно прочитать в статье по ссылке.
12. Пользователь отправляет в чат любое другое сообщение:
    - если это фото или документ, бот сообщает, что необходимо перейти в режим редактирования фото с помощью команды /formatting
    - на любое другое сообщение, возвращается сообщение, что бот не понимает пользователя.
